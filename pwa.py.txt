from pwa import inject_pwa
import streamlit as st

st.markdown(inject_pwa(), unsafe_allow_html=True)

def inject_pwa():
    st.markdown("""
    <link rel="manifest" href="/manifest.json">
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('/service-worker.js');
        }
    </script>
    """, unsafe_allow_html=True)

# pwa.py
def inject_pwa():
    # injecte manifest + enregistrement du service worker
    return """
    <link rel="manifest" href="/manifest.txt">
    <script>
    if ('serviceWorker' in navigator) {
        window.addEventListener('load', function() {
            navigator.serviceWorker.register('/service-worker.txt').then(function(reg) {
                // registration succeeded
            }).catch(function(error) {
                // registration failed
            });
        });
    }
    </script>
    """

